YUI.add("photo-selector-photolist-interaction-view",(function(t){var e=require("hermes-core/type-validator");t.namespace("Views")[this.name]=t.Base.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.hasMultiSelect=t.primaryPhotoListConfig&&t.primaryPhotoListConfig.hasMultiSelect,this.multiSelectLimit=void 0===t.primaryPhotoListConfig.multiSelectLimit?1:t.primaryPhotoListConfig.multiSelectLimit,this.listType=t.primaryPhotoListConfig.type,this.galleryId=t.primaryPhotoListConfig.galleryId,this.isDisabled=!1,this.isDisabledSelected=!1,this},loadState:function(){var e=this,i=[];return"galleryFaves"===this.listType&&this.galleryId&&(i.push(this.appContext.getModelRegistry("gallery-photo-association-models").then((function(t){t.exists(e.galleryId+"-"+e.get("id"))&&(e.isDisabled=!0,e.isDisabledSelected=!0)}))),i.push(this.appContext.getModel("gallery-faves-models",this.appContext.getViewer().nsid+"-"+e.galleryId).then((function(t){var i=t.getValue("nonGalleryAddablePhotos").getList(),s=!1;i&&(s=i.some((function(t){return t.id===e.get("model").id}))),s&&(e.isDisabled=!0)})))),i.push(this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid).then(function(t){t.getValue("photos").getFromListByID(this.get("model").getValue("id"))&&this.set("isActive",!0)}.bind(this))),t.Promise.all(i)},buildContainer:function(){var t=this.get("model");return this.setContainerWithTemplate("photo-selector-photo-list-photo-interaction",{photo:t.toJSON(),photoPageUrl:this.get("photoPageUrl")}),this},activate:function(){var e,i,s=this.get("container"),o=s.one(".disabled-overlay");return this.galleryId&&(e=this.intlMessage({intlName:"gallery.PHOTO_CANT_ADD_TO_GALLERY",mediaType:this.get("model").getValue("mediaType")}),i=this.intlMessage({intlName:"gallery.PHOTO_ALREADY_IN_GALLERY",mediaType:this.get("model").getValue("mediaType")})),this.registerEventHandler(s.on("click",this.selectPhoto.bind(this))),this.hasMultiSelect?this.registerEventHandler(t.on("photoSelector:deselectAll",this.deselectPhoto.bind(this),this)):this.registerEventHandler(t.on("photoSelector:subviewEvent",this.handleOtherPhotoSelected,this)),this.get("isActive")?this.get("isActive")&&s.addClass("active"):s.removeClass("active"),this.isDisabled&&(s.addClass("disabled"),o.setAttribute("title",e)),this.isDisabledSelected&&(s.addClass("disabled-selected"),o.setAttribute("title",i)),this},selectPhoto:function(e){if(e.halt(),!this.isDisabled)if(this.get("isActive")&&this.hasMultiSelect)this.set("isActive",!1),this.get("container").removeClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"unselectPhotoFromPhotoList",id:this.get("id")});else{if(this.hasMultiSelect)return this.appContext.getModel("profile-selected-photos-models",this.appContext.getViewer().nsid).then(function(e){e.getValue("photos").size()+1<=this.multiSelectLimit&&(this.set("isActive",!0),this.get("container").addClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")}))}.bind(this));this.set("isActive",!0),this.get("container").addClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"selectPhotoFromPhotoList",id:this.get("id")})}},deselectPhoto:function(){this.get("isActive")&&(this.set("isActive",!1),this.get("container").removeClass("active"),t.fire("photoSelector:subviewEvent",{eventName:"unselectPhotoFromPhotoList",id:this.get("id")}))},handleOtherPhotoSelected:function(t){if("selectPhotoFromPhotoList"===t.eventName&&this.get("isActive")){if(t.id===this.get("id"))return;this.set("isActive",!1),this.get("container")._node&&this.get("container").removeClass("active")}}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(t,i){return e.photoId(t)}},model:{writeOnce:"initOnly"},photoPageUrl:{writeOnce:"initOnly"}}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-photo-list-photo-interaction","attribute-helpers"],optionalRequires:["fluid","hermes-core"],langBundles:["common","gallery"]});YUI.add("hermes-template-photo-selector-sets-photolist-set-interaction",(function(t,e){var l=t.Template.Handlebars.revive({1:function(t,e,l,n,a){var o,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t\t<span class="album-photo-count">'+t.escapeExpression((s(l,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{selectedCount:null!=(o=null!=e?s(e,"album"):e)?s(o,"publicPhotosCount"):o,intlName:"album-page.PUBLIC_ITEMS_COUNT"},data:a,loc:{start:{line:6,column:36},end:{line:6,column:130}}}))+"</span>\n"},3:function(t,e,l,n,a){var o,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'\t\t\t<span class="album-photo-count">'+t.escapeExpression((s(l,"intlMessage")||e&&s(e,"intlMessage")||t.hooks.helperMissing).call(null!=e?e:t.nullContext||{},{name:"intlMessage",hash:{selectedCount:null!=(o=null!=e?s(e,"album"):e)?s(o,"totalCount"):o,intlName:"album-page.PHOTOS_COUNT"},data:a,loc:{start:{line:8,column:35},end:{line:8,column:116}}}))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(t,e,l,n,a){var o,s=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="photo-list-album-interaction photo-selector-album dark">\n\t<div class="interaction-bar">\n\t\t<h4 class="album-title">'+t.escapeExpression(t.lambda(null!=(o=null!=e?s(e,"album"):e)?s(o,"title"):o,e))+"</h4>\n"+(null!=(o=s(l,"if").call(null!=e?e:t.nullContext||{},null!=e?s(e,"publicOnlyPhotos"):e,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.program(3,a,0),data:a,loc:{start:{line:5,column:2},end:{line:9,column:9}}}))?o:"")+"\t</div>\n</div>\n"},useData:!0}),n={};t.Array.each([],(function(e){var l=t.Template.get("hermes/"+e);l&&(n[e]=l)})),t.Template.register("hermes/photo-selector-sets-photolist-set-interaction",(function(e,a){return(a=a||{}).partials=a.partials?t.merge(n,a.partials):n,l(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-selector-sets-photolist-interaction-view",(function(t){var e=require("hermes-core/type-validator");t.namespace("Views")[this.name]=t.Base.create(this.name,t.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.publicOnlyPhotos=t.publicOnlyPhotos,this},loadState:function(){return this.appContext.getModel(this.get("engagementModelName"),this.get("id")).then(function(t){this.set("engagement",t)}.bind(this))},buildContainer:function(){return this.setContainerWithTemplate("photo-selector-sets-photolist-set-interaction",{album:this.get("model").toJSON(),publicOnlyPhotos:this.publicOnlyPhotos,albumPageUrl:this.get("albumPageUrl")}),this},activate:function(){return this.registerEventHandler(this.get("container").on("click",this.selectSet.bind(this))),this},selectSet:function(e){e.halt(),t.fire("photoSelector:subviewEvent",{eventName:"selectSetFromPhotoList",id:this.get("id"),title:this.get("model").getValue("title")})},destructor:function(){}},{ATTRS:{id:{writeOnce:"initOnly",validator:function(t,i){return e.photoId(t)}},model:{writeOnce:"initOnly"},albumPageUrl:{writeOnce:"initOnly"},engagement:{value:null},engagementModelName:{writeOnce:"initOnly",value:null,validator:function(e,i){return t.AttributeHelpers.validateString(e)}}}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-selector-sets-photolist-set-interaction","attribute-helpers"],optionalRequires:["fluid","hermes-core"],langBundles:["album-page"]});YUI.add("hermes-lang-album-page",(function(e,t){e.Intl.add("hermes/album-page","en-US",{PHOTOS_COUNT:[{type:6,value:"selectedCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"}],PUBLIC_PHOTOS_COUNT:[{type:6,value:"selectedCount",options:{one:{value:[{type:7},{type:0,value:" public photo"}]},other:{value:[{type:7},{type:0,value:" public photos"}]}},offset:0,pluralType:"cardinal"}],PUBLIC_ITEMS_COUNT:[{type:6,value:"selectedCount",options:{one:{value:[{type:7},{type:0,value:" public item"}]},other:{value:[{type:7},{type:0,value:" public items"}]}},offset:0,pluralType:"cardinal"}],VIDEOS_COUNT:[{type:6,value:"selectedCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"}],VIEWS_COUNT:[{type:6,value:"selectedCount",options:{one:{value:[{type:7},{type:0,value:" view"}]},other:{value:[{type:7},{type:0,value:" views"}]}},offset:0,pluralType:"cardinal"}],BACK_TO_ALBUMS:[{type:0,value:"Back to albums list"}],EDIT_IN_ORGANIZR:[{type:0,value:"Edit in Organizr"}],EDIT_COVER:[{type:0,value:"Edit cover"}],SELECT_COVER_PHOTO:[{type:0,value:"Select a cover photo"}],SELECT:[{type:0,value:"Select"}],ERROR_COVER_PHOTO:[{type:0,value:"There was a problem trying to set your cover photo. Please try again."}],ERROR_UPDATING_ALBUM_TITLE_DESCRIPTION:[{type:0,value:"There was an error updating the album’s title and description."}],ALBUM_ADD_DESCRIPTION:[{type:0,value:"Click here to enter a description for this album"}],ERROR_CREATING_PHOTOBOOK_FROM_ALBUM:[{type:0,value:"There was a problem creating the book for this album. Please try again later."}],ALBUM_DESCRIPTION:[{type:0,value:"Album description"}],CREATE_BOOK_FROM_ALBUM:[{type:0,value:"Make a book from this Album"}],DOWNLOAD_PHOTOS_AND_VIDEO:[{type:0,value:"Download "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" & "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"}],DOWNLOAD_PHOTOS:[{type:0,value:"Download "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"}],DOWNLOAD_VIDEOS:[{type:0,value:"Download "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"}],DOWNLOAD_ZIP:[{type:0,value:"Download zip"}],DOWNLOAD_ZIP_PART:[{type:0,value:"Download zip part "},{type:1,value:"partSequence"}],ALOT_OF_PHOTOS:[{type:0,value:"Wow, that’s a lot of photos! Click to download each batch as a zip file."}],DOWNLOAD_ALBUM_NOT_AVAILABLE_ERROR:[{type:0,value:"There are no photos or videos available in this album for you to download."}],DOWNLOAD_ALBUM_DISABLED_ERROR:[{type:0,value:"Album downloading is currently unavailable. Please try again in a minute."}],DOWNLOAD_ALBUM_GENERIC_ERROR:[{type:0,value:"There was an error downloading this album. Please try again."}],DOWNLOAD_ALBUM_LICENSE_MESSAGE:[{type:0,value:"These photos may have one or more license types. Please visit the individual photo page for more information about the license prior to downloading this album."}],DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT:[{type:0,value:"These photos may have one or more license types. Prior to downloading this album, please visit the individual photo pages to understand the designated license type for each image"}],DOWNLOAD_ALBUM_LICENSE_MESSAGE_ALT_2:[{type:0,value:"These photos may have one or more license types or their rights may be reserved. Prior to downloading this album, please visit the individual photo pages to understand the designated license type for each image."}],DOWNLOAD_ALBUM_LEARN_MORE:[{type:0,value:'Learn more at <a href="https://www.flickr.com/creativecommons" target="_blank">Creative Commons</a>'}],CONFIRM_ALBUM_DELETE_NO_CONTENTS_DELETED:[{type:0,value:"Do you really want to delete this album? (Don’t worry, none of the contents will be deleted.)"}],DELETE_THIS_ALBUM:[{type:0,value:"Delete this album"}],SHARE_THIS_ALBUM:[{type:0,value:"Share this album"}],CREATE_NEW_ALBUM:[{type:0,value:"Create new album"}],NEW_ALBUM:[{type:0,value:"New album"}],NEW_COLLECTION:[{type:0,value:"New collection"}],VIEW_COLLECTIONS:[{type:0,value:"View collections"}],VIEW_MY_COLLECTIONS:[{type:0,value:"View my collections"}],SORT:[{type:0,value:"Sort"}],SORT_DATE_TAKEN_OLDEST:[{type:0,value:"Sort by date taken (oldest first)"}],SORT_DATE_TAKEN_NEWEST:[{type:0,value:"Sort by date taken (newest first)"}],SORT_DATE_UPLOADED_OLDEST:[{type:0,value:"Sort by date uploaded (oldest first)"}],SORT_DATE_UPLOADED_NEWEST:[{type:0,value:"Sort by date uploaded (newest first)"}],SORT_ALPHABETICAL:[{type:0,value:"Alphabetical"}],SORT_RANDOMLY:[{type:0,value:"Randomly"}],SORT_REVERSE:[{type:0,value:"Reverse current order"}],SORT_TAKEN_OLDEST:[{type:0,value:"Date taken (oldest first)"}],SORT_TAKEN_NEWEST:[{type:0,value:"Date taken (newest first)"}],SORT_UPLOADED_OLDEST:[{type:0,value:"Date uploaded (oldest first)"}],SORT_UPLOADED_NEWEST:[{type:0,value:"Date uploaded (newest first)"}],SORT_RANDOM:[{type:0,value:"Random"}],SORT_MANUAL_BEGINNING:[{type:0,value:"Manual (add to beginning)"}],SORT_MANUAL_END:[{type:0,value:"Manual (add to end)"}],SORT_ALBUM_TOOLTIP:[{type:0,value:"Items you add to this album will be arranged based on the sort order."}],CHANGE_SORT_ORDER_TITLE:[{type:0,value:"Change sort order?"}],CHANGE_SORT_ORDER_EXPLANATION:[{type:0,value:"If you change the way this album is sorted, your manual sort order will be lost."}],SORT_TYPE_LABEL:[{type:0,value:"Sort:"}],SORT_ALMOST_DONE:[{type:0,value:"Almost done..."}],TIMEOUT_FAILURE:[{type:0,value:"We’re having some trouble displaying this album at the moment. Please try again."}],OPENGRAPH_DESCRIPTION:[{type:0,value:"Explore this photo album by "},{type:1,value:"owner"},{type:0,value:" on Flickr!"}],EDIT_ALBUM:[{type:0,value:"Edit album"}],DELETE_ALBUM:[{type:0,value:"Delete album"}],DELETE_ALBUM_CONFIRMATION:[{type:0,value:"Are you sure you want to delete this album?"}],REMOVE_PHOTO_TITLE:[{type:0,value:"Remove photo"}],REMOVE_PHOTO_MESSAGE:[{type:0,value:"Are you sure you want to remove this photo from the album?"}],X_OF_Y_ITEMS_ADDED_TO_ALBUM:[{type:1,value:"successCountString"},{type:0,value:" of "},{type:1,value:"totalCountString"},{type:0,value:" items were added to the album"}],X_ITEMS_ALREADY_IN_ALBUM:[{type:1,value:"countString"},{type:0,value:" of the items you selected are already in the album."}],X_ITEMS_NOT_ADDED_TO_ALBUM:[{type:6,value:"count",options:{one:{value:[{type:1,value:"countString"},{type:0,value:" item was"}]},other:{value:[{type:1,value:"countString"},{type:0,value:" items were"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" not added for other reasons. Please try to add them again."}],THAT_ALREADY_IN_ALBUM:[{type:0,value:"That item is already in the album."}],THOSE_ALREADY_IN_ALBUM:[{type:0,value:"Those items are already in the album."}]})}),"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-fluid-modal-nav-bar",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,a,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(e,"unless").call(null!=l?l:n.nullContext||{},null!=l?r(l,"disabled"):l,{name:"unless",hash:{},fn:n.program(2,t,0),inverse:n.noop,data:t,loc:{start:{line:5,column:3},end:{line:7,column:14}}}))?o:""},2:function(n,l,e,a,t){var o,r,u=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,c="function",s=n.escapeExpression,m=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<li data-id="'+s(typeof(r=null!=(r=m(e,"id")||(null!=l?m(l,"id"):l))?r:i)===c?r.call(u,{name:"id",hash:{},data:t,loc:{start:{line:6,column:16},end:{line:6,column:22}}}):r)+'" data-value="'+s(typeof(r=null!=(r=m(e,"value")||(null!=l?m(l,"value"):l))?r:i)===c?r.call(u,{name:"value",hash:{},data:t,loc:{start:{line:6,column:36},end:{line:6,column:45}}}):r)+'" '+(null!=(o=m(e,"if").call(u,null!=l?m(l,"searchPillConfig"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:47},end:{line:6,column:113}}}))?o:"")+' class="link '+(null!=(o=m(e,"if").call(u,null!=l?m(l,"selected"):l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:126},end:{line:6,column:157}}}))?o:"")+" "+(null!=(o=m(e,"if").call(u,null!=l?m(l,"hiddenByDefault"):l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:158},end:{line:6,column:194}}}))?o:"")+'" tabindex="0"><a data-value="'+s(typeof(r=null!=(r=m(e,"value")||(null!=l?m(l,"value"):l))?r:i)===c?r.call(u,{name:"value",hash:{},data:t,loc:{start:{line:6,column:224},end:{line:6,column:233}}}):r)+'">'+s(typeof(r=null!=(r=m(e,"name")||(null!=l?m(l,"name"):l))?r:i)===c?r.call(u,{name:"name",hash:{},data:t,loc:{start:{line:6,column:235},end:{line:6,column:243}}}):r)+"</a></li>\n"},3:function(n,l,e,a,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'data-context="'+n.escapeExpression("function"==typeof(o=null!=(o=r(e,"searchPillConfig")||(null!=l?r(l,"searchPillConfig"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"searchPillConfig",hash:{},data:t,loc:{start:{line:6,column:85},end:{line:6,column:105}}}):o)+'"'},5:function(n,l,e,a,t){return"selected"},7:function(n,l,e,a,t){return"hidden"},9:function(n,l,e,a,t){return'\t\t\t<form action="/search" method="get" role="search">\n\t\t\t\t<input type="submit" class="search-icon" tabindex="-1" aria-label="Search" role="button">\n\t\t\t\t<ul class="search-pillbox"></ul>\n\t\t\t\t<input type="text" name="text" value="" class="search-field" autocomplete="off" aria-label="Search" role="textbox">\n\t\t\t</form>\n'},11:function(n,l,e,a,t){return'\t\t\t<span role="button" class="close-x-button">\n\t\t\t\t<svg class="icon icon-close"><use xlink:href="#icon-close"></use></svg>\n\t\t\t</span>\n'},compiler:[8,">= 4.3.0"],main:function(n,l,e,a,t){var o,r=null!=l?l:n.nullContext||{},u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<div class="fluid-modal-nav-bar">\n\t<div class="fluid-modal-nav-content">\n\t\t<ul class="links">\n'+(null!=(o=u(e,"each").call(r,null!=l?u(l,"links"):l,{name:"each",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:4,column:2},end:{line:8,column:11}}}))?o:"")+"\t\t</ul>\n"+(null!=(o=u(e,"if").call(r,null!=l?u(l,"enableSearch"):l,{name:"if",hash:{},fn:n.program(9,t,0),inverse:n.noop,data:t,loc:{start:{line:10,column:2},end:{line:16,column:9}}}))?o:"")+(null!=(o=u(e,"if").call(r,null!=l?u(l,"showCloseXButton"):l,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t,loc:{start:{line:17,column:2},end:{line:21,column:9}}}))?o:"")+"\t</div>\n</div>\n"},useData:!0}),a={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(a[l]=e)})),n.Template.register("hermes/fluid-modal-nav-bar",(function(l,t){return(t=t||{}).partials=t.partials?n.merge(a,t.partials):a,e(l,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-modal-nav-bar-view",(function(e){"use strict";var t;t={css:{nav:".fluid-modal-nav-bar",navContent:".fluid-modal-nav-content",links:".links",link:".link"},options:{}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){var t,i,n=this.get("breakpointConfig")||[],s=this.appContext.viewportData.getWidth();for(this.set("showCloseXButton",void 0===e.showCloseXButton||e.showCloseXButton),this.set("onClose",void 0!==e.onClose?e.onClose:async e=>{}),i=n.sort((function(e,t){return e.maxWidth-t.maxWidth})),t=0;t<i.length;t++)if(s<i[t].maxWidth){this.mobileConfig=i[t],this.set("links",this.mobileConfig.links),this.set("enableSearch",this.mobileConfig.enableSearch);break}return this.set("contextToString",{photos:this.intlMessage({intlName:"groups.PHOTOS"}),photostream:this.intlMessage({intlName:"groups.PHOTOS"}),favorites:this.intlMessage({intlName:"common.FAVORITES"}),faves:this.intlMessage({intlName:"common.FAVORITES"}),albums:this.intlMessage({intlName:"common.ALBUMS"}),everyone:this.intlMessage({intlName:"search.EVERYONE"}),contacts:this.intlMessage({intlName:"search.PEOPLE_YOU_FOLLOW"}),peopleYouFollow:this.intlMessage({intlName:"search.PEOPLE_YOU_FOLLOW"}),discussions:this.intlMessage({intlName:"groups.DISCUSSIONS_LINK_LABEL"}),commons:this.intlMessage({intlName:"commons.THE_COMMONS"})}),this},loadState:function(){return this},buildContainer:function(){var e;return e={links:this.get("links"),enableSearch:this.get("enableSearch"),showCloseXButton:this.get("showCloseXButton")},this.setContainerWithTemplate("fluid-modal-nav-bar",e),this},activate:function(){var e=this.get("container"),t=this,i=e.one(".search-field");let n=e.one(".close-x-button");if(n&&this.registerEventHandler(n.on("click",(e=>{this.get("onClose")(e)}))),this.registerEventHandler(e.on("click",this.handleClick.bind(this))),this.registerEventHandler(e.on("key",this.handleClick.bind(this),"down:13")),this.get("links").forEach((function(i){i.selected&&t.set("currentSelection",e.one('.link[data-id="'+i.id+'"]'))})),this.defaultContext=this.get("links")[0].value,this.get("currentSelection").hasAttribute("data-context")){var s=JSON.parse(this.get("currentSelection").getAttribute("data-context"));this.addPill(s.pillName,this.get("contextToString")[s.scope]),this.registerEventHandler(i.on("key",this.handleSearchFieldKeydown.bind(this),"down:8"))}return this},deselectAll:function(){this.get("container").one(t.css.nav).one(t.css.navContent).one(t.css.links).all(t.css.link).removeClass("selected")},handleClick:function(t){var i,n,s=t.target,a=s.get("parentNode"),l=this.get("container"),r={},o=this.appContext.getViewer().nsid;if("a"===s.getDOMNode().tagName.toLowerCase())t.halt(),this.updateSelectionAndSearchField(a),this.fire("navigation",t);else if(s.hasClass("link"))t.halt(),this.updateSelectionAndSearchField(s),this.fire("navigation",t);else if(s.hasClass("search-pill-remover"))t.halt(),this.removeContext();else if(i=l.one(".search-field"),this.get("enableSearch")&&i&&(n=l.one(".search-field").getDOMNode(),"submit"===s.getDOMNode().type)){t.halt(),r.apiParams={},r.apiParams[e.AttributeHelpers.coerceString(n.name)]=n.value,r.id=e.SearchHelper.generateQueryString(r.apiParams)||e.guid(),r.viewerNsid=o;var h=this.get("currentSelection");h.hasAttribute("data-context")?r.contextSearch=h.getAttribute("data-id"):(this.deselectAll(),this.set("searchData",{type:"search",modelParams:r})),this.fire("search",r)}},reselectTab:function(){this.get("currentSelection")&&this.get("currentSelection").getDOMNode().click()},redoSearch:function(){var e=this.get("searchData");e&&"search"===e.type&&this.fire("search",e.modelParams)},addPill:function(t,i){var n,s={name:t};i&&(s.combo=!0,s.secondName=i),n=e.Node.create(this.templates("search-pill")(s)),this.get("container").one(".search-pillbox").appendChild(n)},removePills:function(){this.get("container").one(".search-pillbox").get("children").remove()},removeContext:function(){var t=this.get("container"),i=t.one(".search-field").getDOMNode(),n={},s=this.appContext.getViewer().nsid,a={},l=t.one('.link[data-id="'+this.defaultContext+'"]');this.removePills(),this.deselectAll(),l.addClass("selected"),this.set("currentSelection",l),a.target=l,i.value.length>0?(n.apiParams={},n.apiParams[e.AttributeHelpers.coerceString(i.name)]=i.value,n.id=e.SearchHelper.generateQueryString(n.apiParams)||e.guid(),n.viewerNsid=s,this.fire("search",n)):this.fire("navigation",a)},handleSearchFieldKeydown:function(t){var i=t.target;0===e.fluid.getTextFieldCursorPosition(i)&&""===e.fluid.getTextFieldSelection()&&this.removeContext()},updateSelectionAndSearchField:function(e){var t,i=this.get("container"),n=i.one(".search-field"),s=i.one(".search-pill");this.deselectAll(),e.addClass("selected"),this.set("currentSelection",e),this.get("currentSelection").hasAttribute("data-context")&&(t=JSON.parse(this.get("currentSelection").getAttribute("data-context"))),n&&(n.getDOMNode().value=""),t?s||this.addPill(t.pillName,this.get("contextToString")[t.scope]):s&&this.removePills()}},{ATTRS:{links:{value:[],validator:function(t){return e.Lang.isArray(t)}},currentSelection:{value:null},enableSearch:{value:!0,validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},breakpointConfig:{value:null}}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-modal-nav-bar","hermes-template-search-pill","attribute-helpers","search-helper"],langBundles:["common","wallart","groups","search","commons"],optional:["person-models","photo-models"]});